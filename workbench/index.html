<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Databanana Workbench</title>
    <link rel="stylesheet" href="style.css">
</head>
<body>
    <div class="container">
        <h1>üçå Databanana Workbench</h1>
        <p class="subtitle">Test AI services independently</p>

        <!-- Common Configuration -->
        <div class="config-section">
            <h2>Configuration</h2>
            <div class="form-group">
                <label for="context">Context:</label>
                <textarea id="context" placeholder="Enter context for image generation..."></textarea>
            </div>
            <div class="form-group">
                <label for="exclude-tags">Exclude Tags:</label>
                <input type="text" id="exclude-tags" placeholder="tag1, tag2, tag3...">
            </div>
            <div class="form-group">
                <label for="num-generations">Number of Generations:</label>
                <input type="number" id="num-generations" value="1" min="1" max="100">
            </div>
            <button id="generate-claude-prompt" class="btn btn-success">Generate Claude Prompt from Configuration</button>
        </div>

        <!-- Step 1: Claude Prompts -->
        <div class="step-section">
            <h2>Step 1: Claude Haiku Prompts</h2>
            <div class="form-group">
                <label for="claude-prompt">Claude Prompt:</label>
                <textarea id="claude-prompt" rows="15" placeholder="Click 'Generate Claude Prompt' above to populate with your configuration..."></textarea>
            </div>
            <button id="send-claude" class="btn btn-primary">Send to Claude</button>
            <button id="populate-claude" class="btn btn-secondary">Populate Example Prompt</button>
            
            <!-- Claude Results -->
            <div id="claude-results" class="results-section" style="display: none;">
                <h3>Claude Response</h3>
                <pre id="claude-response"></pre>
                <button id="next-to-gemini" class="btn btn-success">Next: Gemini Flash</button>
            </div>
        </div>

        <!-- Step 2: Gemini Flash -->
        <div class="step-section">
            <h2>Step 2: Gemini Flash Batch</h2>
            <div class="form-group">
                <label for="gemini-payload">Gemini Batch Payload:</label>
                <textarea id="gemini-payload" rows="20" placeholder="Gemini batch payload will appear here..."></textarea>
            </div>
            <button id="send-gemini" class="btn btn-primary">Send to Gemini Flash</button>
            <button id="populate-gemini" class="btn btn-secondary">Populate Default Payload</button>
            
            <!-- Gemini Results -->
            <div id="gemini-results" class="results-section" style="display: none;">
                <!-- JSON Response -->
                <div class="accordion">
                    <div class="accordion-header" onclick="toggleAccordion('gemini-json')">
                        <h3>üìÑ JSON Response</h3>
                        <span class="accordion-toggle">‚ñº</span>
                    </div>
                    <div id="gemini-json" class="accordion-content">
                        <pre id="gemini-response"></pre>
                    </div>
                </div>
                
                <!-- Gallery View -->
                <div class="accordion">
                    <div class="accordion-header" onclick="toggleAccordion('gemini-gallery')">
                        <h3>üñºÔ∏è Gallery View</h3>
                        <span class="accordion-toggle">‚ñº</span>
                    </div>
                    <div id="gemini-gallery" class="accordion-content">
                        <div id="image-gallery" class="gallery"></div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Loading indicator -->
        <div id="loading" class="loading" style="display: none;">
            <div class="spinner"></div>
            <p>Processing...</p>
        </div>
    </div>

    <!-- Step 4: Edit Images JSON -->
    <div class="step-section">
        <h2 class="step-title" onclick="toggleAccordion('edit-images-content')">
            Step 4: Edit Images JSON 
            <span class="accordion-toggle">‚ñº</span>
        </h2>
        <div id="edit-images-content" class="step-content" style="display: none;">
            <p>Review and edit the generated images JSON before sending to Rekognition. You can modify URLs to test different images.</p>
            
            <div class="section">
                <h3>Images JSON</h3>
                <textarea id="images-json" rows="15" style="width: 100%; font-family: monospace; font-size: 12px;" placeholder="Generated images JSON will appear here after Step 3 completes..."></textarea>
                <div style="margin-top: 10px;">
                    <button id="load-generated-images" class="btn btn-secondary">Load Generated Images</button>
                    <button id="validate-json" class="btn btn-secondary">Validate JSON</button>
                    <p class="helper-text">Edit URLs to test Rekognition on different images. JSON must be a valid array of image objects.</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Step 5: Test Rekognition -->
    <div class="step-section">
        <h2 class="step-title" onclick="toggleAccordion('rekognition-content')">
            Step 5: Test AWS Rekognition 
            <span class="accordion-toggle">‚ñº</span>
        </h2>
        <div id="rekognition-content" class="step-content" style="display: none;">
            <p>Test AWS Rekognition on the images from Step 4.</p>
            
            <div class="section">
                <h3>Image Analysis</h3>
                <p>Analyze images with the JSON from Step 4:</p>
                <button id="analyze-images" class="btn btn-primary">Analyze Images with Rekognition</button>
                <p class="helper-text">This will run AWS Rekognition on the images defined in the JSON above.</p>
            </div>

            <div id="rekognition-results" class="results-section" style="display: none;">
                <h3>Rekognition Results</h3>
                <pre id="rekognition-response"></pre>
                
                <div id="labeled-gallery" class="image-gallery">
                    <!-- Labeled images with bounding boxes will be displayed here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Image Modal -->
    <div id="image-modal" class="modal" style="display: none;">
        <div class="modal-content">
            <span class="close" onclick="closeModal()">&times;</span>
            <img id="modal-image" src="" alt="Full size image">
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>